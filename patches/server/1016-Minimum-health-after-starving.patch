From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: MartijnMuijsers <martijnmuijsers@live.nl>
Date: Thu, 9 Jun 2022 02:09:22 +0200
Subject: [PATCH] Minimum health after starving


diff --git a/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java b/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java
index 2fd93c6f06711f9c2bbfc3d2077306366e5f1d4c..900c4536b1087ebdbc5e20b4a1548b87d788b7bd 100644
--- a/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java
+++ b/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java
@@ -69,11 +69,23 @@ public class WorldConfiguration extends ConfigurationPart {
     public DifficultyChanges difficultyChanges;
 
     public class DifficultyChanges extends ConfigurationPart {
+
         public boolean zombieReinforcementsOnAllDifficulties = false; // Martijn - zombies can call for reinforcements on all difficulties
         public boolean raidsAreAlwaysHard = false; // Martijn - raids are always hard
         public boolean caveSpidersHavePoisonOnEasyDifficulty = false; // Martijn - cave spiders have poison on easy difficulty
         public boolean witherEffectFromWitherSkullsOnEasyDifficulty = false; // Martijn - wither effect from wither skulls on easy difficulty
         public boolean lightningSpawnsFire = true; // Martijn - configurable lightning fire
+
+        // Martijn start - minimum health after starving
+
+        /**
+         * -1 indicates no minimum (it may still be limited by the difficulty)
+         * Valid values are -1 or a nonnegative floating-point number
+         */
+        public float minimumHealthAfterStarving = -1f;
+
+        // Martijn end - minimum health after starving
+
     }
 
     // Martijn end - difficulty changes
diff --git a/src/main/java/net/minecraft/world/food/FoodData.java b/src/main/java/net/minecraft/world/food/FoodData.java
index 2934b6de1f1fb914a532ee20184df99d1acd8e65..b58d06d651729d7fbcc93ee1368e1bb6364a9c45 100644
--- a/src/main/java/net/minecraft/world/food/FoodData.java
+++ b/src/main/java/net/minecraft/world/food/FoodData.java
@@ -100,7 +100,7 @@ public class FoodData {
         } else if (this.foodLevel <= 0) {
             ++this.tickTimer;
             if (this.tickTimer >= this.starvationRate) { // CraftBukkit - add regen rate manipulation
-                if (player.getHealth() > 10.0F || enumdifficulty == Difficulty.HARD || player.getHealth() > 1.0F && enumdifficulty == Difficulty.NORMAL) {
+                if ((player.level.paperConfig().difficultyChanges.minimumHealthAfterStarving < 0.0F || player.getHealth() > player.level.paperConfig().difficultyChanges.minimumHealthAfterStarving) && (player.getHealth() > 10.0F || enumdifficulty == Difficulty.HARD || player.getHealth() > 1.0F && enumdifficulty == Difficulty.NORMAL)) { // Martijn - minimum health after starving
                     player.hurt(DamageSource.STARVE, 1.0F);
                 }
 
